<section class="section">
  <h1 class="title is-1">Hacktoberfest events</h1>
  <p>
    Hacktoberfest events are organized by individuals and organizations in your community. (Thank you, everyone!) We kindly ask you to follow the Hacktoberfest Events Code of Conduct when organizing or attending an event.
  </p>

<div id="meetups">
  <input name="filter" class="search input" placeholder="Search for events" />
  
  <h2 class="highlight">Showing <span data-js="visible_event_count"> all <%= @meetups.length %></span> Events</h2>

  <table class="table is-narrow is-narrow is-fullwidth event-table">
    <thead>
    <tr>
      <th><abbr title="Location" class="sort" data-sort="location">Location</abbr></th>
      <th><abbr title="Event" class="sort" data-sort="event_name">Event</abbr></th>
      <th><abbr title="Date" class="sort" data-sort="date">Date</abbr></th>
    </tr>
    </thead>
    <tbody class="list">
      <% @meetups.map do |m| %>
      <tr>
        <td class="multisort is-hidden">
          <%= m["Event Country"] %> 
          <%= DateTime.parse( m["Event Start Date/Time"]).strftime("%b %e") %>
        </td>
        <td class="location">
          <%= m["Event City"] %>,
          <%= m["Event State"] || '' %>
          <%= m["Event Country"] %>
        </td>
        <td class="event_name">
          <a class="emphasis" href="<%= m["Event URL"] %>" target="blank" rel="noopener"><%= m["Event Name"] %></a>
          <br/>
          by <%= m["Event Organizer"] %>
        </td>
        <td class="date"><%= DateTime.parse( m["Event Start Date/Time"]).strftime("%b %e") %></td>
      </tr>
      <% end %>
    </tbody>
  </table>
  <section>
  <h2 class="title is-2">Submit your Hacktoberfest 2019 event</h2>
  <div>
    <%= link_to 'Submit event', event_kit_path + "/#form" %>
  </div>
  </section>
</section>
<script>
  var event_count_display = document.querySelector('*[data-js="visible_event_count"]'),
      meetupsList = new List('meetups', {
    valueNames: ['multisort', 'location', 'event_name', 'date']
  });
  meetupsList.sort('multisort', { order: "asc" });
  meetupsList.on('updated', function(){
    event_count_display.innerText = meetupsList.visibleItems.length;
  })
</script>